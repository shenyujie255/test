{"version":3,"sources":["webpack:///src/page/city/City.vue","webpack:///./src/page/city/City.vue?e8af","webpack:///./src/page/city/City.vue"],"names":["City","data","inputVaule","cityid","cityname","historytitle","placelist","placeNone","placeHistory","mounted","_this","this","$route","params","Object","getDate","then","res","name","initData","components","headTop","head","methods","postpois","_this2","console","log","length","mUtils","JSON","parse","nextpage","index","geohash","history","choosePlace","checkrepeat","forEach","item","push","$router","path","query","clearAll","city_City","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","head-title","go-back","slot","to","_v","on","submit","$event","preventDefault","directives","rawName","value","expression","type","placeholder","required","domProps","input","target","composing","click","_e","_l","key","_s","address","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/9.fbed613c6dd991e944f7.js","sourcesContent":["<template>\r\n  <div class=\"city_container\"> \r\n    <head-top :head-title=\"cityname\" go-back=\"ture\">\r\n      <router-link to=\"/home\" slot=\"changecity\" class=\"change_city\">切换城市</router-link>\r\n    </head-top>\r\n    <!-- city搜索历史 -->\r\n    <form class=\"city_form\" v-on:submit.prevent>\r\n      <div>\r\n        <!-- 双向绑定信息渲染到getsearch_ul -->\r\n        <input type=\"text\" placeholder=\"输入学校、商务楼、地址\"  class=\"city_input input_style\" required v-model=\"inputVaule\">\r\n      </div>\r\n      <div>\r\n        <!-- 提交按钮，调用postpois方法-->\r\n        <input type=\"submit\" value=\"提交\"  class=\"city_button input_style\" @click=\"postpois\">\r\n      </div>\r\n    </form>\r\n    <header v-if=\"historytitle\" class=\"search_history\">搜索历史</header>\r\n    <ul class=\"getsearch_ul\">\r\n      <li v-for=\"(item, index) in placelist\" @click=\"nextpage(index,item.geohash)\" :key=\"index\">\r\n        <h4 class=\"pois_name ellipsis\">{{ item.name }}</h4>\r\n        <p class=\"pois_address ellipsis\">{{ item.address }}</p>\r\n      </li>\r\n    </ul>\r\n    <footer class=\"clear_all_history\"  v-if=\"historytitle&&placelist.length\"  @click=\"clearAll\">清空所有</footer>\r\n    <div class=\"search_none_place\" v-if=\"placeNone\">很抱歉！无搜索结果</div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport headTop from '../../components/head/head'\r\nimport {currentcity,searchplace} from '../../service/getDate.js'\r\nimport { getStore,setStore,removeStore } from \"../../utils/mUtils.js\";\r\n\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      inputVaule:'', // 搜索地址\r\n      cityid:'', // 当前城市id\r\n      cityname:'', //城市名字\r\n      historytitle: true, //默认显示搜索历史头部，点击搜索后隐藏\r\n      placelist:[],       // 搜索地址列表\r\n      placeNone: false,   //默认不显示，搜索无结果，显示提示信息\r\n      placeHistory:[],  // 历史搜索列表\r\n    }\r\n  },\r\n  mounted () {\r\n      this.cityid = this.$route.params.cityid;\r\n      //获取当前城市名字\r\n      currentcity(this.cityid).then(res => {\r\n      this.cityname = res.name;\r\n      }),\r\n      this.initData();\r\n  },\r\n  components:{\r\n    headTop,\r\n  },\r\n  methods: {\r\n    // 调用postpois方法提交inputvalue信息\r\n    postpois(){\r\n       if (this.inputVaule) {\r\n        searchplace(this.cityid, this.inputVaule).then(res=>{\r\n          this.historytitle = false;\r\n          this.placelist = res;\r\n          console.log(this.placelist)\r\n          //三目运算符判断是否显示placeNone\r\n          this.placeNone = res.length? false : true;\r\n        })\r\n      }\r\n    },\r\n    //获取搜索历史记录\r\n    initData(){\r\n      //获取搜索历史记录\r\n      if(getStore('placeHistory')){\r\n        this.placelist = JSON.parse(getStore('placeHistory'));\r\n      }else{\r\n        this.placelist = [];\r\n      }\r\n    },\r\n    //跳转进入商铺列表页面\r\n    nextpage(index, geohash){\r\n        /**\r\n       * 点击搜索结果进入下一页面时进行判断是否已经有一样的历史记录\r\n       * 如果没有则新增，如果有则不做重复储存，判断完成后进入下一页\r\n       */\r\n        let history = getStore('placeHistory');\r\n        let choosePlace = this.placelist[index];\r\n        if (history) {\r\n        let checkrepeat = false;\r\n        this.placeHistory = JSON.parse(history);   //JSON.parse将接受的数据转换成对象\r\n        this.placeHistory.forEach(item => {\r\n        if (item.geohash == geohash) {\r\n          checkrepeat = true;\r\n        }\r\n        })\r\n        if (!checkrepeat) {\r\n          this.placeHistory.push(choosePlace)\r\n        }\r\n        }else {\r\n          this.placeHistory.push(choosePlace)\r\n        }\r\n        setStore('placeHistory',this.placeHistory)\r\n        this.$router.push({path:'/miste', query:{geohash}})\r\n    },\r\n    //清除所有搜索方法\r\n    clearAll(){\r\n      removeStore('placeHistory');\r\n      this.initData();\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.city_container{\r\n  padding-top: 2.35rem;\r\n}\r\n.change_city{\r\n  right: .4rem;\r\n  position: absolute;\r\n  font-size: .6rem;\r\n  color: #fff;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n}\r\n.city_form{\r\n  background-color: #fff;\r\n  border-top: 1px solid #e4e4e4;\r\n  border-bottom: 1px solid #e4e4e4;\r\n  padding-top: .4rem;\r\n}\r\n.city_form div{\r\n  width: 90%;\r\n  margin: 0 auto;\r\n  text-align: center;\r\n}\r\n.input_style{\r\nwidth: 100%;\r\nheight: 1.4rem;\r\nmargin-bottom: .4rem;\r\noutline: none;\r\nborder-radius: .1rem;\r\nborder: none;\r\nfont-family: \"Microsoft Yahei\";\r\n}\r\n.city_form .city_input{\r\n  border: 1px solid #e4e4e4;\r\n  font-size: 0.65rem;\r\n  padding: 0 0.3rem;\r\n}\r\n.city_button{\r\n  background-color: #3190e8;\r\n  color: #fff;\r\n  font-size: 0.65rem;\r\n}\r\n.search_history{\r\n  font: 0.475rem/0.8rem \"Microsoft YaHei\";\r\n  border-top: 1px solid #e4e4e4;\r\n  border-bottom: 1px solid #e4e4e4;\r\n  padding-left: .5rem;\r\n  color: #333;\r\n}\r\n.getsearch_ul{\r\n  background: #fff;\r\n  border-top: 1px solid #e4e4e4;\r\n}\r\n.getsearch_ul li{\r\n  border-bottom: 1px solid #e4e4e4;\r\n  padding-top: .65rem;\r\n  margin:  0 auto;\r\n}\r\n.getsearch_ul li .pois_name{\r\n  width: 90%;\r\n  font-size: .65rem;\r\n  color:#333;\r\n  margin: 0 auto .35rem;\r\n}\r\n.getsearch_ul li .pois_address{\r\n  width: 90%;\r\n  margin: 0 auto .55rem;\r\n  font-size: .45rem;\r\n  color: #999;\r\n}\r\n.ellipsis {\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n}\r\n.search_none_place{\r\n  font: 0.65rem/1.75rem \"Microsoft YaHei\";\r\n  background-color: #fff;\r\n  text-indent: .5rem;\r\n  color: #333;\r\n  margin: 0 auto;\r\n}\r\n.clear_all_history{\r\n  text-align: center;\r\n  color: #666;\r\n  font-size: .7rem;\r\n  background-color: #fff;\r\n  line-height: 2rem;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/page/city/City.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"city_container\"},[_c('head-top',{attrs:{\"head-title\":_vm.cityname,\"go-back\":\"ture\"}},[_c('router-link',{staticClass:\"change_city\",attrs:{\"slot\":\"changecity\",\"to\":\"/home\"},slot:\"changecity\"},[_vm._v(\"切换城市\")])],1),_vm._v(\" \"),_c('form',{staticClass:\"city_form\",on:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.inputVaule),expression:\"inputVaule\"}],staticClass:\"city_input input_style\",attrs:{\"type\":\"text\",\"placeholder\":\"输入学校、商务楼、地址\",\"required\":\"\"},domProps:{\"value\":(_vm.inputVaule)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.inputVaule=$event.target.value}}})]),_vm._v(\" \"),_c('div',[_c('input',{staticClass:\"city_button input_style\",attrs:{\"type\":\"submit\",\"value\":\"提交\"},on:{\"click\":_vm.postpois}})])]),_vm._v(\" \"),(_vm.historytitle)?_c('header',{staticClass:\"search_history\"},[_vm._v(\"搜索历史\")]):_vm._e(),_vm._v(\" \"),_c('ul',{staticClass:\"getsearch_ul\"},_vm._l((_vm.placelist),function(item,index){return _c('li',{key:index,on:{\"click\":function($event){return _vm.nextpage(index,item.geohash)}}},[_c('h4',{staticClass:\"pois_name ellipsis\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('p',{staticClass:\"pois_address ellipsis\"},[_vm._v(_vm._s(item.address))])])}),0),_vm._v(\" \"),(_vm.historytitle&&_vm.placelist.length)?_c('footer',{staticClass:\"clear_all_history\",on:{\"click\":_vm.clearAll}},[_vm._v(\"清空所有\")]):_vm._e(),_vm._v(\" \"),(_vm.placeNone)?_c('div',{staticClass:\"search_none_place\"},[_vm._v(\"很抱歉！无搜索结果\")]):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6b1da336\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/page/city/City.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6b1da336\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./City.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./City.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./City.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6b1da336\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./City.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6b1da336\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/city/City.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}